diff -Nru pgplot-orig/drivers/pndriv.c pgplot-fixed/drivers/pndriv.c
--- pgplot-orig/drivers/pndriv.c	1999-03-26 18:06:23.000000000 -0800
+++ pgplot-fixed/drivers/pndriv.c	2013-02-27 09:52:19.609181994 -0800
@@ -222,7 +222,11 @@
 	return;
   }
 
+#if PNG_LIBPNG_VER >= 10500
+  if (setjmp(png_jmpbuf(png_ptr))) {
+#else
   if (setjmp(png_ptr->jmpbuf)) { /* not really sure what I'm doing here... */
+#endif
 	fprintf(stderr,"%s: error in libpng while writing file %s, plotting disabled\n", png_ident, filename);
 	png_destroy_write_struct(&png_ptr,&info_ptr);
 	dev->error = true;
